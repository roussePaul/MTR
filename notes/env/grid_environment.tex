% Author: Rasmus Pank Roulund
\documentclass{standalone}
\usepackage{tikz}
\usetikzlibrary{shapes.geometric, arrows, positioning, calc, fit, arrows, decorations.pathreplacing}

\begin{document}

\begin{tikzpicture}[scale=4.0]


\def\outsize{1.25}
\draw[draw=none] (-\outsize,-\outsize) rectangle (\outsize,\outsize); 

\def\xd{0.25}

\draw[fill=blue!30!white] (0,0) rectangle (1.,1.);
\draw[fill=red!30!white] (-1.,-1.) rectangle (0.,0.);

%\draw[step=\xd cm,gray,very thin] (-1.,-1.) grid (1.,1.);

\def\xd{0.25}
\def\yd{0.25}

\def\xmax{1}
\def\xmin{-1}
\def\ymax{1}
\def\ymin{-1}

% grid
\pgfmathsetmacro\xs{\xmin+\xd}
\pgfmathsetmacro\ys{\ymin+\yd}
\foreach \x in {\xmin,\xs,...,\xmax} \draw (\x,\ymin) -- (\x,\ymax);
\foreach \x in {\ymin,\ys,...,\ymax} \draw (\xmin,\x) -- (\xmax,\x);

\draw[line width=0.8pt] (\xmin,\ymin) rectangle (\xmax,\xmax);

\node[draw,anchor=north west] at (0,1) {b};
\node[draw,anchor=north west] at (-1,0) {a};


% axis
\draw[->,line width=0.55pt] (0,0) -- (0,\ymax+0.1) node(yaxis) [above] {$x_2$};
\draw[->,line width=0.55pt] (0,0) -- (\xmax+0.1,0) node(xaxis) [above] {$x_1$};
        
\draw[decorate,decoration={brace,amplitude=3pt,mirror}] (1.02,\xd) --node[anchor=west,inner sep=5pt] {$x_d$} (1.02,2*\xd); 

\draw[decorate,decoration={brace,amplitude=3pt,mirror}] (-1.0,-1.02) --node[anchor=north,inner sep=7pt] {$N$ columns} (1.,-1.02); 
\draw[decorate,decoration={brace,amplitude=3pt}] (-1.02,-1.) --node[rotate=90,anchor=south,inner sep=7pt] {$N$ rows} (-1.02,1.); 

\coordinate (pt1) at (-0.23,-0.35);
\coordinate (pt2) at (0.13,-0.03);
\coordinate (w) at (0.21,0.21);

\draw[mark=*,mark size=0.2,draw=none] plot coordinates {(pt1)} -- plot coordinates {(pt2)} ;

\draw[->,shorten >=1pt]  (pt1) -- node[anchor=south east] {$\mathbf{u}_n$} (pt2) ;
\node[anchor=north east] at (pt1) {$\mathbf{x}_n$};
\node[anchor=north west] at (pt2) {$\mathbf{x}_{n+1}$};

\draw[draw,dashed] ($(pt2)-(w)$) rectangle ($(pt2)+(w)$) node[anchor=north east] {$\mathbf{w}$};

\end{tikzpicture}

\end{document}
